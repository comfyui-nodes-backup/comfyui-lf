{"file":"kul-upload.entry.js","mappings":"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","names":[],"sources":["src/components/kul-upload/kul-upload-declarations.ts","src/components/kul-upload/kul-upload.scss?tag=kul-upload&encapsulation=shadow","src/components/kul-upload/kul-upload.tsx"],"sourcesContent":["import { KulEventPayload } from '../../types/GenericTypes';\n\n//#region Events\nexport type KulUploadEvent =\n    | 'delete'\n    | 'pointerdown'\n    | 'ready'\n    | 'unmount'\n    | 'upload';\nexport interface KulUploadEventPayload\n    extends KulEventPayload<'KulUpload', KulUploadEvent> {\n    selectedFiles: File[];\n}\n//#endregion\n\n//#region Props\nexport enum KulUploadProps {\n    kulLabel = \"Sets the button's label.\",\n    kulRipple = 'When set to true, the pointerdown event will trigger a ripple effect.',\n    kulStyle = 'Custom style of the component.',\n    kulValue = 'Initializes the component with these files.',\n}\nexport interface KulUploadPropsInterface {\n    kulLabel?: string;\n    kulRipple?: boolean;\n    kulStyle?: string;\n    kulValue?: File[];\n}\n//#endregion\n","@import './styles/kul-upload-main.scss';\n@import './styles/kul-upload-classes.scss';\n","import {\n    Component,\n    Element,\n    Event,\n    EventEmitter,\n    forceUpdate,\n    h,\n    Host,\n    Method,\n    Prop,\n    State,\n} from '@stencil/core';\nimport { KulDebugLifecycleInfo } from '../../managers/kul-debug/kul-debug-declarations';\nimport { kulManagerInstance } from '../../managers/kul-manager/kul-manager';\nimport { GenericObject } from '../../types/GenericTypes';\nimport { getProps } from '../../utils/componentUtils';\nimport { KUL_STYLE_ID, KUL_WRAPPER_ID } from '../../variables/GenericVariables';\nimport {\n    KulUploadEvent,\n    KulUploadEventPayload,\n    KulUploadProps,\n} from './kul-upload-declarations';\n\n@Component({\n    tag: 'kul-upload',\n    styleUrl: 'kul-upload.scss',\n    shadow: true,\n})\nexport class KulUpload {\n    /**\n     * References the root HTML element of the component (<kul-upload>).\n     */\n    @Element() rootElement: HTMLKulUploadElement;\n\n    //#region States\n    /**\n     * Debug information.\n     */\n    @State() debugInfo: KulDebugLifecycleInfo = {\n        endTime: 0,\n        renderCount: 0,\n        renderEnd: 0,\n        renderStart: 0,\n        startTime: performance.now(),\n    };\n    /**\n     *State holding the selected files\n     * @default []\n     */\n    @State() selectedFiles: File[] = [];\n    //#endregion\n\n    //#region Props\n    /**\n     * Sets the button's label.\n     * @default \"Upload files...\"\n     */\n    @Prop({ mutable: true, reflect: true }) kulLabel = 'Upload files...';\n    /**\n     * When set to true, the pointerdown event will trigger a ripple effect.\n     * @default true\n     */\n    @Prop({ mutable: true, reflect: true }) kulRipple = true;\n    /**\n     * Enables customization of the component's style.\n     * @default \"\" - No custom style applied by default.\n     */\n    @Prop({ mutable: true, reflect: true }) kulStyle = '';\n    /**\n     * Initializes the component with these files.\n     * @default null\n     */\n    @Prop({ mutable: false }) kulValue = null;\n    //#endregion\n\n    //#region Internal variables\n    #input: HTMLInputElement;\n    #kulManager = kulManagerInstance();\n    #rippleSurface: HTMLElement;\n    //#endregion\n\n    //#region Events\n    @Event({\n        eventName: 'kul-upload-event',\n        composed: true,\n        cancelable: false,\n        bubbles: true,\n    })\n    kulEvent: EventEmitter<KulUploadEventPayload>;\n    onKulEvent(e: Event | CustomEvent, eventType: KulUploadEvent, file?: File) {\n        switch (eventType) {\n            case 'delete':\n                this.selectedFiles = this.selectedFiles.filter(\n                    (f) => f !== file\n                );\n                break;\n\n            case 'pointerdown':\n                if (this.kulRipple) {\n                    this.#kulManager.theme.ripple.trigger(\n                        e as PointerEvent,\n                        this.#rippleSurface\n                    );\n                }\n                break;\n        }\n        this.kulEvent.emit({\n            comp: this,\n            eventType,\n            id: this.rootElement.id,\n            originalEvent: e,\n            selectedFiles: this.selectedFiles,\n        });\n    }\n    //#endregion\n\n    //#region Public methods\n    /**\n     * Retrieves the debug information reflecting the current state of the component.\n     * @returns {Promise<KulDebugLifecycleInfo>} A promise that resolves to a KulDebugLifecycleInfo object containing debug information.\n     */\n    @Method()\n    async getDebugInfo(): Promise<KulDebugLifecycleInfo> {\n        return this.debugInfo;\n    }\n    /**\n     * Retrieves the properties of the component, with optional descriptions.\n     * @param {boolean} descriptions - If true, returns properties with descriptions; otherwise, returns properties only.\n     * @returns {Promise<GenericObject>} A promise that resolves to an object where each key is a property name, optionally with its description.\n     */\n    @Method()\n    async getProps(descriptions?: boolean): Promise<GenericObject> {\n        return getProps(this, KulUploadProps, descriptions);\n    }\n    /**\n     * Returns the component's internal value.\n     */\n    @Method()\n    async getValue(): Promise<File[]> {\n        return this.selectedFiles;\n    }\n    /**\n     * Triggers a re-render of the component to reflect any state changes.\n     */\n    @Method()\n    async refresh(): Promise<void> {\n        forceUpdate(this);\n    }\n    /**\n     * Initiates the unmount sequence, which removes the component from the DOM after a delay.\n     * @param {number} ms - Number of milliseconds\n     */\n    @Method()\n    async unmount(ms: number = 0): Promise<void> {\n        setTimeout(() => {\n            this.onKulEvent(new CustomEvent('unmount'), 'unmount');\n            this.rootElement.remove();\n        }, ms);\n    }\n    //#endregion\n\n    //#region Private methods\n    #formatFileSize(size: number): string {\n        const units = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n        let unitIndex = 0;\n\n        if (size > 10000) {\n            size /= 1024;\n            size /= 1024;\n            unitIndex = 2;\n        } else {\n            while (size >= 1024 && unitIndex < units.length - 1) {\n                size /= 1024;\n                unitIndex++;\n            }\n        }\n\n        return `${size.toFixed(2)} ${units[unitIndex]}`;\n    }\n    #handleFileChange() {\n        if (this.#input.files) {\n            this.selectedFiles = Array.from(this.#input.files);\n        } else {\n            this.selectedFiles = [];\n        }\n        this.onKulEvent(new CustomEvent('upload'), 'upload');\n    }\n    #prepFileInfo() {\n        return this.selectedFiles.map((file, index) => (\n            <div class=\"file-info__item\" key={index}>\n                <kul-image\n                    class=\"file-info__type\"\n                    kulValue={\n                        file.type.includes('image')\n                            ? 'image'\n                            : file.type.includes('audio')\n                              ? 'audiotrack'\n                              : file.type.includes('video')\n                                ? 'movie'\n                                : 'file'\n                    }\n                    kulSizeX=\"24px\"\n                    kulSizeY=\"24px\"\n                    title={file.type}\n                ></kul-image>\n                <span class=\"file-info__name\" title={file.name}>\n                    {file.name}\n                </span>\n                <span class=\"file-info__size\" title={file.size.toString()}>\n                    {this.#formatFileSize(file.size)}\n                </span>\n                <kul-button\n                    class=\"file-info__clear\"\n                    kulIcon={'clear'}\n                    kulStyling=\"flat\"\n                    onClick={(e) => {\n                        this.onKulEvent(e, 'delete', file);\n                    }}\n                    title=\"Remove\"\n                ></kul-button>\n            </div>\n        ));\n    }\n    //#endregion\n\n    //#region Lifecycle hooks\n    componentWillLoad() {\n        this.#kulManager.theme.register(this);\n        if (Array.isArray(this.kulValue)) {\n            this.selectedFiles = this.kulValue;\n        }\n    }\n    componentDidLoad() {\n        this.onKulEvent(new CustomEvent('ready'), 'ready');\n        if (this.#rippleSurface) {\n            this.#kulManager.theme.ripple.setup(this.#rippleSurface);\n        }\n        this.#kulManager.debug.updateDebugInfo(this, 'did-load');\n    }\n    componentWillRender() {\n        this.#kulManager.debug.updateDebugInfo(this, 'will-render');\n    }\n    componentDidRender() {\n        this.#kulManager.debug.updateDebugInfo(this, 'did-render');\n    }\n    render() {\n        const hasSelectedFiles =\n            this.selectedFiles && this.selectedFiles.length;\n        return (\n            <Host>\n                {this.kulStyle ? (\n                    <style id={KUL_STYLE_ID}>\n                        {this.#kulManager.theme.setKulStyle(this)}\n                    </style>\n                ) : undefined}\n                <div id={KUL_WRAPPER_ID}>\n                    <div\n                        class={`wrapper ${\n                            this.selectedFiles && this.selectedFiles.length\n                                ? 'wrapper--with-info'\n                                : ''\n                        }`}\n                    >\n                        <div\n                            class=\"file-upload\"\n                            onPointerDown={(e) =>\n                                this.onKulEvent(e, 'pointerdown')\n                            }\n                        >\n                            <input\n                                class=\"file-upload__input\"\n                                id=\"upload-input\"\n                                multiple\n                                onChange={() => this.#handleFileChange()}\n                                ref={(el) => {\n                                    this.#input = el;\n                                }}\n                                type=\"file\"\n                            />\n                            <label\n                                class=\"file-upload__label\"\n                                htmlFor=\"upload-input\"\n                                ref={(el) => {\n                                    if (this.kulRipple) {\n                                        this.#rippleSurface = el;\n                                    }\n                                }}\n                            >\n                                <div class=\"file-upload__text\">\n                                    {this.kulLabel}\n                                </div>\n                            </label>\n                        </div>\n                        <div class=\"file-info\">\n                            {hasSelectedFiles\n                                ? this.#prepFileInfo()\n                                : undefined}\n                        </div>\n                    </div>\n                </div>\n            </Host>\n        );\n    }\n    disconnectedCallback() {\n        this.#kulManager.theme.unregister(this);\n    }\n    //#endregion\n}\n"],"version":3}